<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Space tutorial &mdash; pyny3d 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyny3d 0.1 documentation" href="index.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>pyny3d 0.1 documentation</span></a></h1>
        <h2 class="heading"><span>Space tutorial</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <p>Back to <a class="reference internal" href="tutorial.html#tutorials"><span>Tutorials</span></a></p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#space-tutorial" id="id2">Space tutorial</a><ul>
<li><a class="reference internal" href="#non-trivial-methods" id="id3">Non-trivial methods</a><ul>
<li><a class="reference internal" href="#get-map-map2seed-map2pyny" id="id4">get_map, map2seed, map2pyny</a></li>
<li><a class="reference internal" href="#photo" id="id5">photo</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="space-tutorial">
<span id="tutorial-space"></span><h1><a class="toc-backref" href="#id2">Space tutorial</a><a class="headerlink" href="#space-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/space.png"><img alt="_images/space.png" src="_images/space.png" style="width: 560.0px; height: 417.9px;" /></a>
<p class="caption"><span class="caption-text"><em>Example of a Space with six individual Places.</em></span></p>
</div>
<span class="target" id="module-pyny3d.geoms"></span><dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pyny3d.geoms.</code><code class="descname">Space</code><span class="sig-paren">(</span><em>places=[]</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyny3d/geoms.html#Space"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Highest geometry class. Aggregate <code class="docutils literal"><span class="pre">pyny.Places</span></code> to compute 
operations simultaneously on a group of them. It can be initialized
empty.</p>
<dl class="docutils">
<dt>The lower level instances will be stored in:</dt>
<dd><ul class="first last simple">
<li><strong>Space.places</strong></li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>places</strong> (list of <code class="docutils literal"><span class="pre">pyny.Place</span></code>) &#8211; Places or empty list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<p>Most of the funtionalities of this library are implemented only for
<code class="docutils literal"><span class="pre">pyny.Space</span></code> instances, such as compute shadows. Some of most 
handy are: <a class="reference internal" href="doc.html#pyny3d.geoms.Space.move" title="pyny3d.geoms.Space.move"><code class="xref py py-func docutils literal"><span class="pre">move()</span></code></a>, <a class="reference internal" href="doc.html#pyny3d.geoms.Space.zrotate" title="pyny3d.geoms.Space.zrotate"><code class="xref py py-func docutils literal"><span class="pre">zrotate()</span></code></a>, <a class="reference internal" href="doc.html#pyny3d.geoms.Space.matrix" title="pyny3d.geoms.Space.matrix"><code class="xref py py-func docutils literal"><span class="pre">matrix()</span></code></a> or 
<a class="reference internal" href="doc.html#pyny3d.geoms.Space.mirror" title="pyny3d.geoms.Space.mirror"><code class="xref py py-func docutils literal"><span class="pre">mirror()</span></code></a>.</p>
<p>Instances of this class work as iterable object. When indexed, 
returns the <code class="docutils literal"><span class="pre">pyny.Places</span></code> which conform it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class is implemented to be used dynamically. Once
created, it is possible to add elements, with 
<code class="docutils literal"><span class="pre">.add_places</span></code>, <code class="docutils literal"><span class="pre">.add_spaces</span></code> among others, without replace 
it.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Although it is a dynamic class, it is recommended to 
use the methods to manipulate it. Editing the internal 
attributes or methods directly can result in a bad behavior.</p>
</div>
</dd></dl>

<div class="section" id="non-trivial-methods">
<h2><a class="toc-backref" href="#id3">Non-trivial methods</a><a class="headerlink" href="#non-trivial-methods" title="Permalink to this headline">¶</a></h2>
<p>As always, you can also use the <a class="reference internal" href="doc.html#doc-space"><span>Space</span></a> documentation for
method-by-method description, specially for the trivial methods we
are going to skip in this section.</p>
<p><strong>Trivial methods:</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">method</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>.add_places()</td>
<td>Add new places to the space</td>
</tr>
<tr class="row-odd"><td>.add_space()</td>
<td>Merge other spaces with this one</td>
</tr>
<tr class="row-even"><td>.add_set_of_points()</td>
<td>Add a set of points</td>
</tr>
<tr class="row-odd"><td>.clear_set_of_points()</td>
<td>Remove the points in this place</td>
</tr>
<tr class="row-even"><td>.explode()</td>
<td>Collect all the polygons, holes and points
in the space</td>
</tr>
<tr class="row-odd"><td>.explode_map()</td>
<td>Faster version of .explode()</td>
</tr>
<tr class="row-even"><td>.get_height()</td>
<td>Returns the z value for a list of points</td>
</tr>
<tr class="row-odd"><td>.mesh()</td>
<td>Generates a list of points homogeneously
distributed</td>
</tr>
<tr class="row-even"><td>.lock()</td>
<td>Precomputes some values to speedup
shadowing</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The methods to <strong>transform</strong> the classes are explained in detail separately
in <a class="reference internal" href="tutorial_transformations.html#tutorial-transformations"><span>Transformations</span></a>.</p>
<div class="section" id="get-map-map2seed-map2pyny">
<h3><a class="toc-backref" href="#id4">get_map, map2seed, map2pyny</a><a class="headerlink" href="#get-map-map2seed-map2pyny" title="Permalink to this headline">¶</a></h3>
<p>An Space&#8217;s map is an array that contains all the points of the Space
appropriately identified by an index. This way of representing all the
elements in a Space is very useful to transform it. Indeed, all the
<a class="reference internal" href="tutorial_transformations.html#tutorial-transformations"><span>Transformations</span></a> are matrix operations to these maps.</p>
<p>It is important to undertand the index given by the <code class="docutils literal"><span class="pre">.get_map()</span></code> method:</p>
<blockquote>
<div><ul class="simple">
<li>The first column is the Place.</li>
<li>The second column is the body (-1: points, 0: surface, n: polyhedron)</li>
<li>The third column is the polygon (-n: holes)</li>
<li>The fourth column is the point.</li>
</ul>
</div></blockquote>
<p>After modifying a map, we usually want to reconstruct the Space. With this
purpose we have <code class="docutils literal"><span class="pre">.map2seed()</span></code> and <code class="docutils literal"><span class="pre">.map2pyny()</span></code> methods.</p>
<p>Here we have an example where a whole Space is translated:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">   ...: </span><span class="kn">import</span> <span class="nn">pyny3d.geoms</span> <span class="kn">as</span> <span class="nn">pyny</span>
<span class="gp">   ...: </span>
<span class="gp">   ...: </span><span class="c1"># Declaring the geometry</span>
<span class="gp">   ...: </span><span class="c1">## Surface</span>
<span class="gp">   ...: </span><span class="n">poly_surf_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">]]),</span>
<span class="gp">   ...: </span>               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]]),</span>
<span class="gp">   ...: </span>               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">3.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]]),</span>
<span class="gp">   ...: </span>               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">3.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]])]</span>
<span class="gp">   ...: </span><span class="n">poly_surf_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">]])]</span>
<span class="gp">   ...: </span>
<span class="gp">   ...: </span><span class="c1">## Obstacles</span>
<span class="gp">   ...: </span><span class="n">wall_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">   ...: </span><span class="n">wall_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">14.7</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mf">14.7</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">   ...: </span><span class="n">chimney</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">   ...: </span>
<span class="gp">   ...: </span><span class="c1"># Building the solution</span>
<span class="gp">   ...: </span><span class="n">place_0</span> <span class="o">=</span> <span class="n">pyny</span><span class="o">.</span><span class="n">Place</span><span class="p">(</span><span class="n">poly_surf_0</span><span class="p">,</span> <span class="n">melt</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">place_0</span><span class="o">.</span><span class="n">add_extruded_obstacles</span><span class="p">([</span><span class="n">wall_1</span><span class="p">,</span> <span class="n">wall_2</span><span class="p">,</span> <span class="n">chimney</span><span class="p">])</span>
<span class="gp">   ...: </span><span class="n">place_1</span> <span class="o">=</span> <span class="n">pyny</span><span class="o">.</span><span class="n">Place</span><span class="p">(</span><span class="n">poly_surf_1</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">space</span> <span class="o">=</span> <span class="n">pyny</span><span class="o">.</span><span class="n">Space</span><span class="p">([</span><span class="n">place_0</span><span class="p">,</span> <span class="n">place_1</span><span class="p">])</span>
<span class="gp">   ...: </span><span class="n">space</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="gp">   ...: </span><span class="c1"># Viz</span>
<span class="gp">   ...: </span><span class="n">space</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">c_poly</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/space_1.png"><img alt="_images/space_1.png" src="_images/space_1.png" style="width: 560.0px; height: 417.9px;" /></a>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">index</span><span class="p">,</span> <span class="n">map_</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">get_map</span><span class="p">()</span>

<span class="gp">In [3]: </span><span class="n">index</span>  <span class="c1"># points reference</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">array([[ 0, -1,  0,  0],</span>
<span class="go">       [ 0, -1,  0,  1],</span>
<span class="go">       [ 0, -1,  0,  2],</span>
<span class="go">       ...,</span>
<span class="go">       [ 1,  0,  0,  1],</span>
<span class="go">       [ 1,  0,  0,  2],</span>
<span class="go">       [ 1,  0,  0,  3]])</span>

<span class="gp">In [4]: </span><span class="n">map_</span>  <span class="c1"># points</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">array([[  0.5,   0. ,   0.1],</span>
<span class="go">       [  1. ,   0. ,   0.1],</span>
<span class="go">       [  1.5,   0. ,   0.1],</span>
<span class="go">       ...,</span>
<span class="go">       [ 15. ,   0. ,   0. ],</span>
<span class="go">       [ 15. ,   9. ,   0. ],</span>
<span class="go">       [  8. ,   9. ,   0. ]])</span>

<span class="gp">In [5]: </span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="c1"># total number of points in the Space</span>
<span class="gh">Out[5]: </span><span class="go">940</span>

<span class="gp">In [6]: </span><span class="n">map_</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>  <span class="c1"># translation in x, y, and z</span>

<span class="gp">In [7]: </span><span class="n">map_</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">array([[ 100.5,  200. ,  300.1],</span>
<span class="go">       [ 101. ,  200. ,  300.1],</span>
<span class="go">       [ 101.5,  200. ,  300.1],</span>
<span class="go">       ...,</span>
<span class="go">       [ 115. ,  200. ,  300. ],</span>
<span class="go">       [ 115. ,  209. ,  300. ],</span>
<span class="go">       [ 108. ,  209. ,  300. ]])</span>

<span class="gp">In [8]: </span><span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">map2pyny</span><span class="p">(</span><span class="n">map_</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">space</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">c_poly</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/map.png"><img alt="_images/map.png" src="_images/map.png" style="width: 560.0px; height: 417.9px;" /></a>
</div>
<p>As we have seen, it is very easy to transform a whole space by applying only
a single matrix operation and reconstructing it later. I encourage you to
create and share (or suggest) the transformations that you require for your
applications. Due to this package was created with the shadowing simulations
idea in mind, it may lack of elaborated or complex transformations but I
hope that as more people start using it this problem gets solved.</p>
</div>
<div class="section" id="photo">
<h3><a class="toc-backref" href="#id5">photo</a><a class="headerlink" href="#photo" title="Permalink to this headline">¶</a></h3>
<p>The photo&#8217;s documentation is quite extense (maybe too extense) so I refer to it
for the explanation. I am going to extract only this part:</p>
<blockquote>
<div><em>In short, this methods answer &#8220;How would the Space look in
a photograph taken from an arbitrary direction in cylindrical
perpective?&#8221;</em></div></blockquote>
<p>That is, what is the vision of the Sun? Let&#8217;s have a look:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="n">poly_hole_points</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">photo</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>  <span class="c1"># Oblique</span>

<span class="gp">In [11]: </span><span class="n">poly_hole_points</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">photo</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>  <span class="c1"># Zenital</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/photo.png"><img alt="_images/photo.png" src="_images/photo.png" style="width: 764.7900000000001px; height: 290.97px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Next tutorial: <a class="reference internal" href="tutorial_pip_and_classify.html#tutorial-pip-and-classify"><span>PiP and Classify tutorial</span></a></p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, José Antonio Fernández-Fernández.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>